(()=>{(()=>{function K(e,t,n){let l=e.dataset.dselectValue,s=e.closest(`.${t}`).previousElementSibling,r=s.nextElementSibling.getElementsByClassName(n)[0],d=s.nextElementSibling.querySelector("input");s.multiple?Array.from(s.options).filter(g=>g.value===l)[0].selected=!0:s.value=l,s.multiple&&r.click(),s.dispatchEvent(new Event("change")),r.focus(),d&&(d.value="")}function Q(e,t,n){let l=e.parentNode.dataset.dselectValue,s=e.closest(`.${t}`).previousElementSibling,r=s.nextElementSibling.getElementsByClassName(n)[0],d=s.nextElementSibling.querySelector("input");Array.from(s.options).filter(g=>g.value===l)[0].selected=!1,s.dispatchEvent(new Event("change")),r.click(),d&&(d.value="")}function W(e,t,n,l,s,r){let d=t.value.toLowerCase().trim(),g=t.nextElementSibling,b=Array.from(g.querySelectorAll(".dropdown-header")),E=Array.from(g.querySelectorAll(".dropdown-item")),w=g.nextElementSibling;if(b.forEach(i=>i.classList.add("d-none")),E.forEach(i=>{let p=i.textContent.toLowerCase().includes(d);if(i.classList.toggle("d-none",!p),p){let c=i.previousElementSibling;for(;c&&!c.classList.contains("dropdown-header");)c.classList.remove("d-none"),c=c.previousElementSibling}}),b.forEach(i=>{let p=i.textContent.toLowerCase().includes(d);if(i.classList.toggle("d-none",!p),p){let c=i.nextElementSibling;for(;c&&!c.classList.contains("dropdown-header");)c.classList.remove("d-none"),c=c.nextElementSibling}}),E.filter(i=>!i.classList.contains("d-none")&&!i.hasAttribute("hidden")).length===0){if(w.classList.remove("d-none"),g.classList.add("d-none"),s&&(w.innerHTML=r.replace("[searched-term]",t.value),e.key==="Enter")){let i=t.closest(`.${n}`).previousElementSibling,p=i.nextElementSibling.querySelector(`.${l}`);i.insertAdjacentHTML("afterbegin",`<option value="${t.value}" selected>${t.value}</option>`),i.dispatchEvent(new Event("change")),t.value="",t.dispatchEvent(new Event("keyup")),p.click(),p.focus()}}else w.classList.add("d-none"),g.classList.remove("d-none")}function X(e,t){let n=e.closest(`.${t}`).previousElementSibling;Array.from(n.options).forEach(l=>l.selected=!1),n.dispatchEvent(new Event("change"))}function Z(e,t={}){e.style.display="none";let n="dselect-wrapper",l="dselect-no-results",s="dselect-tag-remove",r="dselect-tag",d="dselect-placeholder",g="dselect-clear",b="dselect-clearable",E="text-bg-dark bg-gradient",w=!1,i=!1,p=!1,c="360px",k="",M="",T="Search..",C="Press Enter to add &quot;<strong>[searched-term]</strong>&quot;",H="No results found",a=N("search")||t.search||w,h=N("creatable")||t.creatable||i,f=N("clearable")||t.clearable||p,B=e.dataset.dselectMaxHeight||t.maxHeight||c,L=e.dataset.dselectClassTag||t.classTag||E,P=`${r} ${L}`,x=e.dataset.dselectSearchPlaceholder||t.searchPlaceholder||T,q=e.dataset.dselectNoResultsPlaceholder||t.noResultsPlaceholder||H,j=e.dataset.dselectAddOptionPlaceholder||t.addOptionPlaceholder||C,O=e.dataset.dselectItemClass||t.ItemClass||M,S=e.dataset.dselectSize||t.size||k,$=`form-select${S!==""?` form-select-${S}`:""}`,ne=a?`<input onkeydown="return event.key !== 'Enter'" onkeyup="dselectSearch(event, this, '${n}', '${$}', ${h}, '${j}')" type="text" class="form-control" placeholder="${x}" autofocus>`:"";function N(u){let m=`data-dselect-${u}`;return e.hasAttribute(m)?e.getAttribute(m).toLowerCase()==="true":null}function se(){e.nextElementSibling&&e.nextElementSibling.classList&&e.nextElementSibling.classList.contains(n)&&e.nextElementSibling.remove()}function I(u){return u.getAttribute("value")===""}function F(u,m){if(m){let o=Array.from(u).filter(y=>y.selected&&!I(y)),A=Array.from(u).filter(y=>I(y)),v=[];if(o.length===0){let y=A.length?A[0].textContent:"&nbsp;";v.push(`<span class="${d}">${y}</span>`)}else for(let y of o)v.push(`
            <div class="${P}" data-dselect-value="${y.value}">
              ${y.text}
              <svg onclick="dselectRemoveTag(this, '${n}', '${$}')" class="${s}" width="14" height="14" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"/></svg>
            </div>
          `);return v.join("")}else{let o=u[u.selectedIndex];return I(o)?`<span class="${d}">${o.innerHTML}</span>`:o.innerHTML}}function G(u){let m=u[u.selectedIndex];return I(m)?"":m.textContent}function Y(u){let m=[];for(let o of u)if(o.tagName==="OPTGROUP")m.push(`<h6 class="dropdown-header">${o.getAttribute("label")}</h6>`);else{let A=I(o)?" hidden":"",v=o.selected?" active":"",y=o.selected?" disabled":"",oe=o.getAttribute("disabled"),ie=O===""?"":" "+O,z="";oe!==null?z="disabled='true'":z="";let re=o.value,R=o.textContent;if(o.hasAttribute("data-dselect-img")&&o.getAttribute("data-dselect-img").trim()!==""){let de=o.getAttribute("data-dselect-img").trim(),D="1rem";S=="sm"?D=".7rem":S=="lg"&&(D="1.2rem"),R=`<span class="d-flex align-items-center">
            <img src="${de}" style="max-height:${D}; width:auto;">
            <span class="ps-2">${R}</span>
          </span>`}m.push(`<button${A} class="dropdown-item${v}${ie}"  ${z} data-dselect-value="${re}" type="button" onclick="dselectUpdate(this, '${n}', '${$}')" ${y}>
          ${R}
        </button>`)}return m=m.join(""),m}function le(){let u=e.multiple?' data-bs-auto-close="outside"':"",m=Array.from(e.classList).filter(v=>v!=="form-select"&&v!=="form-select-sm"&&v!=="form-select-lg").join(" "),o=f&&!e.multiple?`
    <button type="button" class="btn ${g}" title="Clear selection" onclick="dselectClear(this, '${n}')">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" fill="none">
        <path d="M13 1L0.999999 13" stroke-width="2" stroke="currentColor"></path>
        <path d="M1 1L13 13" stroke-width="2" stroke="currentColor"></path>
      </svg>
    </button>
    `:"",A=`
    <div class="dropdown ${n} ${m}">
      <button class="${$} ${!e.multiple&&f?b:""}" data-dselect-text="${!e.multiple&&G(e.options)}" type="button" data-bs-toggle="dropdown" aria-expanded="false"${u}>
        ${F(e.options,e.multiple)}
      </button>
      <div class="dropdown-menu">
        <div class="d-flex flex-column">
          ${ne}
          <div class="dselect-items" style="max-height:${B};overflow:auto">
            ${Y(e.querySelectorAll("*"))}
          </div>
          <div class="${l} d-none">${q}</div>
        </div>
      </div>
      ${o}
    </div>
    `;se(),e.insertAdjacentHTML("afterend",A),e.nextElementSibling.addEventListener("shown.bs.dropdown",function(){let v=this.querySelector('input[type="text"]');v&&v.focus()})}le();function ae(){let u=e.nextElementSibling,m=u.getElementsByClassName($)[0],o=u.getElementsByClassName("dselect-items")[0];m.innerHTML=F(e.options,e.multiple),o.innerHTML=Y(e.querySelectorAll("*")),e.multiple||(m.dataset.dselectText=G(e.options))}e.addEventListener("change",ae)}typeof window<"u"&&(window.dselectUpdate=K,window.dselectRemoveTag=Q,window.dselectSearch=W,window.dselectClear=X,window.dselect=Z);function ce(e){let t="";function n(l){if(Array.isArray(l))l.forEach(s=>n(s));else if(typeof l=="object")for(let s in l)n(l[s]);else t+=l+","}return n(e),t.slice(0,-1)}function U(e,t){let n=document.createElement("div"),l=document.createElement("div"),s=document.createElement("div"),r=document.createElement("div"),d=new Date,g=d.toLocaleString();return n.classList.add("d-flex"),l.classList.add("flex-shrink-0","text-center"),s.classList.add("text-secondary","border-top","border-secondary","text-right","fs-6"),s.innerHTML=g,e==="ai"?(r.classList.add("shadow","flex-grow-1","ms-3","border","rounded","p-2","mb-2","ai-chat","bg-body-tertiary"),l.classList.add("order-0"),l.innerHTML='<img src="/assets/svg/ai-6e9dd4.svg" alt="ai" style="max-width:75px; height:auto;">'):(r.classList.add("shadow","flex-grow-1","me-3","border","rounded","p-2","mb-2","user-chat","bg-secondary-subtle"),l.classList.add("order-1"),l.innerHTML='<img src="/assets/svg/me-639dd4.svg" alt="ai" style="max-width:75px; height:auto;">'),r.innerHTML=t,r.append(s),n.append(l),n.append(r),n}async function _(e,t){let n=[];return n.prompt=await ee(e),n.model=await te(t),n}var J={};async function ee(e){let t=await(await fetch("assets/data/prompts.json")).json();return console.log("prompts"),console.log(t),Object.entries(await t).forEach(([n,l])=>{let s=document.createElement("option");s.value=n,s.text=n,e.appendChild(s),J[n]=l}),dselect(e),e}var V={};async function te(e){let t=await(await fetch("assets/data/models.json")).json();return Object.entries(t).forEach(([n,l])=>{let s=document.createElement("option");s.value=n,s.text=l.name,s.setAttribute("data-dselect-img",l.img),e.appendChild(s),V[n]=l}),dselect(e),e}document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("chat-form"),t=document.getElementById("chatMsg"),n=document.getElementById("resp"),l=document.getElementById("chat-box"),s=document.getElementById("loading-icon"),r=document.getElementById("sidePanel"),d=document.getElementById("settings-btn"),g=document.getElementById("to-do-list"),b=document.getElementById("to-do-btn"),E=document.getElementById("main-chat");e.addEventListener("submit",async a=>{a.preventDefault();let h=t.value;s.classList.remove("d-none");let f=marked.parse(h),B=U("user",f);l.insertBefore(B,n);let L=new FormData;L.append("hello","Yohn"),L.append("chatMsg",h);let P=Object.fromEntries(L);try{let x=await fetch("/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(P)});if(!x.ok)throw new Error("Network response was not ok.");t.value="";let q=new Event("input",{bubbles:!0});t.dispatchEvent(q);let j=await x.json();console.log(JSON.stringify(j));let O=marked.parse(j.aiResp),S=U("ai",O);l.insertBefore(S,n),l.querySelectorAll("pre code").forEach($=>{hljs.highlightElement($)}),s.classList.add("d-none")}catch(x){console.error("Error:",x)}});let w=document.getElementById("prompt-preset-select"),i=document.getElementById("model-preset-select"),p=document.getElementById("type-model");_(w,i),w.addEventListener("change",async a=>{systemPrompt.value=J[a.target.value]}),i.addEventListener("change",async a=>{p.innerHTML=`<img src="${V[key].img}" alt="Model">`}),t.addEventListener("input",function(){this.style.height="auto";let a=Math.min(this.scrollHeight,window.innerHeight*.4);this.style.height=a+"px"}),Array.from(document.querySelectorAll('[data-bs-toggle="tooltip"]')).forEach(a=>{new bootstrap.Tooltip(a)});function c(a){let h=parseInt(E.getAttribute("data-yo-col")),f=a=="up"?h+3:h-3;E.classList.remove("col-"+h),E.classList.add("col-"+f),E.setAttribute("data-yo-col",f)}r.addEventListener("show.bs.collapse",a=>{d.classList.toggle("btn-primary"),d.classList.toggle("btn-outline-primary"),r.classList.toggle("font-zero"),c("down")}),r.addEventListener("hide.bs.collapse",a=>{d.classList.toggle("btn-primary"),d.classList.toggle("btn-outline-primary"),r.classList.toggle("font-zero"),c("up")}),g.addEventListener("show.bs.collapse",a=>{b.classList.toggle("btn-primary"),b.classList.toggle("btn-outline-primary"),b.classList.toggle("font-zero"),c("down")}),g.addEventListener("hide.bs.collapse",a=>{b.classList.toggle("btn-primary"),b.classList.toggle("btn-outline-primary"),b.classList.toggle("font-zero"),c("up")}),document.getElementById("bgColor").addEventListener("input",function(){document.body.style.backgroundColor=this.value});let k=document.getElementById("gradientStart"),M=document.getElementById("gradientEnd"),T=document.getElementById("gradientOpacity");k.addEventListener("input",C),M.addEventListener("input",C),T.addEventListener("input",C);function C(){let a=k.value,h=M.value,f=T.value;document.body.style.backgroundImage=`linear-gradient(to right, ${H(a,f)}, ${H(h,f)})`}function H(a,h){let f=parseInt(a.slice(1,3),16),B=parseInt(a.slice(3,5),16),L=parseInt(a.slice(5,7),16);return`rgba(${f}, ${B}, ${L}, ${h})`}})})();})();
//!-------------------------------------------------------------------!
//!
//!------------------------------------------------------------------------!
